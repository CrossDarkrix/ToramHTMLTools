<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>トーラムオンライン クリティカルダメージ計算ツール</title>
<script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/brython@3.9/brython.min.js">
</script>
<script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/brython@3.9/brython_stdlib.js">
</script>
</head>
<body onload="brython()">
<script type="text/python">
from browser import document, html, bind
from math import floor as flr
document["TITLE"] <= "クリティカルダメージ計算ツール"
TEXT_Feild = document["text_field"]
def STRss():
	STR_MSG = html.DIV("STR値(ステータス):")
	STRs = html.INPUT()
	STR_Percent_MSG = html.DIV("STR値(%)の合計値:")
	STRs_Percent = html.INPUT()
	CRTDMG_MSG = html.DIV("合計クリティカルダメージ:")
	CriticalDamages = html.INPUT()
	CRTDMG_Percent_MSG = html.DIV("合計クリティカルダメージ(%):")
	CrtDamage_Percents = html.INPUT()
	SkillCRTD_MSG = html.DIV("クリティカルUpのレベル:")
	SkillCRTD = html.INPUT()
	Submit_BTNs = html.BUTTON("計算する")

	TEXT_Feild <= STR_MSG + STRs + STR_Percent_MSG + STRs_Percent + CRTDMG_MSG + CriticalDamages + CRTDMG_Percent_MSG + CrtDamage_Percents + SkillCRTD_MSG + SkillCRTD + html.BR() + Submit_BTNs
	STRs.focus()
	STRs_Percent.focus()
	CriticalDamages.focus()
	CrtDamage_Percents.focus()
	SkillCRTD.focus()

	return  STRs, STRs_Percent, CriticalDamages, CrtDamage_Percents, SkillCRTD, Submit_BTNs

def sclear():
	document["RESULT"].clear()

def main():
	STR, STR_Percent, CriticalDamage, CrtDamage_Percent, SkillCrtD, Submit_BTN = STRss()
	@bind(Submit_BTN,"click")
	def click(cl):
		sclear()
		try:
			skillLevel = int(SkillCrtD.value)
		except ValueError:
			skillLevel = 1

		if skillLevel == 1:
			SkillCrtDamage = 0
		elif skillLevel == 2:
			SkillCrtDamage = 1
		elif skillLevel == 3:
			SkillCrtDamage = 1
		elif skillLevel == 4:
			SkillCrtDamage = 2
		elif skillLevel == 5:
			SkillCrtDamage = 2
		elif skillLevel == 6:
			SkillCrtDamage = 3
		elif skillLevel == 7:
			SkillCrtDamage = 3
		elif skillLevel == 8:
			SkillCrtDamage = 4
		elif skillLevel == 9:
			SkillCrtDamage = 4
		elif skillLevel == 10:
			SkillCrtDamage = 5
		else:
			document["RESULT"] <= "エラー: バトルスキルのレベルが既定値範囲外です。"

		StrPercent = int(STR.value) * (int(STR_Percent.value) / 100)
		AllSTR = 150 + ((StrPercent + int(STR.value)) / 5)
		CRtSTR = 150 + (int(STR.value) / 5)
		CriticalDamage_Percent = CRtSTR * ((int(CrtDamage_Percent.value) + SkillCrtDamage) / 100)

		AllCriticalDamage = AllSTR + int(CriticalDamage.value) + flr(CriticalDamage_Percent)
		document["RESULT"] <= "あなたのクリティカルダメージは: {CRTDAMAGE}です。".format(CRTDAMAGE=flr(AllCriticalDamage))
main()
</script>
	<h2 id="TITLE"></h2>
	<div>
		Tips:<br>
			「STR値(ステータス)」にはステータスの値(料理の値を含む)を入れてね<br>
			「STR値(%)の合計値」には武器や鎧、クリスタのSTR%を入れてね<br>
			「合計クリティカルダメージ」には武器や鎧やクリスタ、エンチャントの合計クリティカルダメージを入れてね<br>
			「合計クリティカルダメージ(%)」には武器や鎧やクリスタ、エンチャントの合計クリティカルダメージ(%)を入れてね<br>
			「クリティカルUpのレベル」にはバトルスキルのクリティカルUpのレベルを入れてね(空欄でも可)<br><br>
	</div>
	<div id="text_field"></div>
	<h2 id="RESULT" style="color: red;"></h2>

        </body>

    </html>